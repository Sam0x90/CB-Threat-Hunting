name: SmashJacker - Persistence, T1176 Extension loaded into browser at process start
index_type: events
description: Detects the execution of a browser (chrome or edge) with the suspicious parameter --load-extension to force installing a browser extension without any user interaction. This has been observed with SmashJacker as described by Red Canary Threat Report 2024. 
references: 
    - https://redcanary.com/threat-detection-report/threats/smashjacker/
	- https://attack.mitre.org/techniques/T1176/
tags: smashjacker, persistence, t1176
search_query: (process_name:chrome.exe OR process_name:msedge.exe) AND cmdline:--load-extension
on_hit: alert, syslog