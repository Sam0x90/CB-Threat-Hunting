name: Pikabot - C2, T1573 Potential C2 activity via rundll32
index_type: events
description: Detects the execution of rundll32 that leads to an external network connection. The malware Pikabot has been seen to use this technique to initiate C2-communication through hard-coded Windows binaries.
references: https://github.com/SigmaHQ/sigma/blob/master/rules-emerging-threats/2023/Malware/Pikabot/net_connection_win_malware_pikabot_rundll32_activity.yml
tags: pikabot, c2, t1573
search_query: os_type:windows AND (parent_name:rundll32.exe AND (process_name:SearchFilterHost.exe OR process_name:SearchProtocolHost.exe OR process_name:sndvol.exe OR process_name:wermgr.exe OR process_name:wwahost.exe)) AND netconn_count:*
on_hit: alert, syslog