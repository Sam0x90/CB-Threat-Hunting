name: SmashJacker - Persistence, T1546.010 Modification of AppInit DLLs registry for persistence
index_type: events
description: Detects the modification of AppInit DLLs related registry keys for persistence. This is a mechanisms to load a DLL into almost every process that uses user32.dll. This has been observed being used by SmashJacker as described in Red Canary Threat Report 2024. 
references: 
    - https://redcanary.com/threat-detection-report/threats/smashjacker/
	- https://attack.mitre.org/techniques/T1546/010/
tags: smashjacker, persistence, t1546.010
search_query: process_name:reg.exe AND cmdline:add AND cmdline:appinit_dlls
on_hit: alert, syslog