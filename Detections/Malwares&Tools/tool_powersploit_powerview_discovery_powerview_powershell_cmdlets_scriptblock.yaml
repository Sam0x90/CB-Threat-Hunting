name: PowerSploit Powerview - Discovery, PowerView PowerShell cmdlets scriptblock
index_type: events
description: Detects
references:
    - https://github.com/SigmaHQ/sigma/blob/master/rules/windows/powershell/powershell_script/posh_ps_powerview_malicious_commandlets.yml
    - https://powersploit.readthedocs.io/en/latest/Recon/
tags: powersploit, powerview, discovery
search_query: os_type:windows AND (fileless_scriptload_cmdline:Export-PowerViewCSV* OR fileless_scriptload_cmdline:Find-DomainLocalGroupMember* OR fileless_scriptload_cmdline:Find-DomainObjectPropertyOutlier* OR fileless_scriptload_cmdline:Find-DomainProcess* OR fileless_scriptload_cmdline:Find-DomainShare* OR fileless_scriptload_cmdline:Find-DomainUserEvent* OR fileless_scriptload_cmdline:Find-DomainUserLocation* OR fileless_scriptload_cmdline:Find-ForeignGroup* OR fileless_scriptload_cmdline:Find-ForeignUser* OR fileless_scriptload_cmdline:Find-GPOComputerAdmin* OR fileless_scriptload_cmdline:Find-GPOLocation* OR fileless_scriptload_cmdline:Find-InterestingDomain* OR fileless_scriptload_cmdline:Find-InterestingFile* OR fileless_scriptload_cmdline:Find-LocalAdminAccess* OR fileless_scriptload_cmdline:Find-ManagedSecurityGroups* OR fileless_scriptload_cmdline:Get-CachedRDPConnection* OR fileless_scriptload_cmdline:Get-DFSshare* OR fileless_scriptload_cmdline:Get-DomainDFSShare* OR fileless_scriptload_cmdline:Get-DomainDNSRecord* OR fileless_scriptload_cmdline:Get-DomainDNSZone* OR fileless_scriptload_cmdline:Get-DomainFileServer* OR fileless_scriptload_cmdline:Get-DomainGPOComputerLocalGroupMapping* OR fileless_scriptload_cmdline:Get-DomainGPOLocalGroup* OR fileless_scriptload_cmdline:Get-DomainGPOUserLocalGroupMapping* OR fileless_scriptload_cmdline:Get-LastLoggedOn* OR fileless_scriptload_cmdline:Get-LoggedOnLocal* OR fileless_scriptload_cmdline:Get-NetFileServer* OR fileless_scriptload_cmdline:Get-NetForest* OR fileless_scriptload_cmdline:Get-NetGPOGroup* OR fileless_scriptload_cmdline:Get-NetProcess* OR fileless_scriptload_cmdline:Get-NetRDPSession* OR fileless_scriptload_cmdline:Get-RegistryMountedDrive* OR fileless_scriptload_cmdline:Get-RegLoggedOn* OR fileless_scriptload_cmdline:Get-WMIRegCachedRDPConnection* OR fileless_scriptload_cmdline:Get-WMIRegLastLoggedOn* OR fileless_scriptload_cmdline:Get-WMIRegMountedDrive* OR fileless_scriptload_cmdline:Get-WMIRegProxy* OR fileless_scriptload_cmdline:Invoke-ACLScanner* OR fileless_scriptload_cmdline:Invoke-CheckLocalAdminAccess* OR fileless_scriptload_cmdline:Invoke-EnumerateLocalAdmin* OR fileless_scriptload_cmdline:Invoke-EventHunter* OR fileless_scriptload_cmdline:Invoke-FileFinder* OR fileless_scriptload_cmdline:Invoke-Kerberoast* OR fileless_scriptload_cmdline:Invoke-MapDomainTrust* OR fileless_scriptload_cmdline:Invoke-ProcessHunter* OR fileless_scriptload_cmdline:Invoke-RevertToSelf* OR fileless_scriptload_cmdline:Invoke-ShareFinder* OR fileless_scriptload_cmdline:Invoke-UserHunter* OR fileless_scriptload_cmdline:Invoke-UserImpersonation* OR fileless_scriptload_cmdline:Remove-RemoteConnection* OR fileless_scriptload_cmdline:Request-SPNTicket* OR fileless_scriptload_cmdline:Resolve-IPAddress*)
on_hit: alert, syslog