name: Impacket - Credential Access, T1003 Remote Impacket execution and secretsdump output file
index_type: events
description: Detects Impacketâ€™s secretsdump.py script on a target host. The command is commonly executed by svchost.exe, where regsvc.dll is loaded which allows the export of credentials from the registry. The output is redirected to an eight-character TMP file within the System32 directory.
references: 
    - https://attack.mitre.org/software/S0357/
    - https://redcanary.com/threat-detection-report/threats/impacket/
tags: impacket, s0357, credential_access, t1003
search_query: process_name:svchost.exe AND modload:regsvc.dll AND filemod:windows\system32\*.tmp
on_hit: alert, syslog