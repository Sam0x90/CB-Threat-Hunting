name: Impacket - Execution, T1053, Lateral Movement, T1021.002 Remote scheduled task script atexec.py execution with temp output file
index_type: events
description: Detects Impacket’s atexec.py script on a target host. atexec.py is remotely run via SMB on an adversary’s machine to execute commands on the victim via scheduled task. The command is commonly executed by a non-interactive cmd.exe with the output redirected to an eight-character TMP file.
references: 
    - https://redcanary.com/threat-detection-report/threats/impacket/
	- https://attack.mitre.org/software/S0357/
tags: impacket, s0357, execution, t1053, lateral_movement, t1021.002
search_query: (parent_name:svchost.exe OR parent_name:taskeng.exe) AND (cmdline:"cmd.exe" AND cmdline:"/c" AND cmdline:windows\temp AND cmdline:2 AND cmdline:"&1") AND filemod:windows\temp\*.tmp
on_hit: alert, syslog