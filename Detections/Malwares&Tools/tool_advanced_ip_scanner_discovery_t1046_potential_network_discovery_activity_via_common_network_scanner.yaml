name: Advanced IP Scanner - Discovery, T1046, potential network discovery activity via common network scanner
index_type: events
description: Detects the use of Advanced IP Scanner. This is a popular tool for ransomware groups and other TAs.
references: 
    - https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pua_advanced_ip_scanner.yml
    - https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_advanced_ip_scanner.yml
    - https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Other/Advanced%20IP%20Scanner
    - https://app.any.run/tasks/c73630e0-a3ca-40fe-9301-392e8f61f170/
    - https://attack.mitre.org/techniques/T1046/
tags: discovery, t1046
search_query: os_type:windows AND ((path:advanced_ip_scanner* OR path:Advanced\ IP\ Scanner* OR path:AdvanceIPScannerPortable OR original_filename:advanced_ip_scanner.exe OR orginal_filename:advanced_ip_scanner_console.exe OR file_desc:Advanced\ IP\ Scanner) OR (cmdline:/portable AND cmdline:/lng) OR filemod:*Advanced\ IP\ Scanner*)
on_hit: alert, syslog
