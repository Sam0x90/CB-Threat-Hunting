name: Darkgate - C2, T1105 Autoit3.exe file creation by uncommon process
index_type: events
description: Detects the usage of curl.exe, KeyScramblerLogon, or other non-standard/suspicious processes used to create Autoit3.exe. This activity has been associated with DarkGate malware, which uses Autoit3.exe to execute shellcode that performs process injection and connects to the DarkGate command-and-control server. Curl, KeyScramblerLogon, and these other processes consitute non-standard and suspicious ways to retrieve the Autoit3 executable.
references: https://github.com/SigmaHQ/sigma/blob/master/rules-emerging-threats/2023/Malware/DarkGate/file_event_win_malware_darkgate_autoit3_binary_creation.yml
tags: darkgate, c2, t1105
search_query: os_type:windows AND ((process_name:Autoit3.exe OR process_name:curl.exe OR process_name:ExtExport.exe OR process_name:KeyScramblerLogon.exe OR process_name:wmprph.exe) AND filemod:Autoit3.exe)
on_hit: alert, syslog