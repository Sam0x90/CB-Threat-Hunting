name: Darkgate - Execution, T1059 Darkgate autoit3.exe suspicious execution tree from uncommon location
index_type: events
description: Detects execution of the legitimate Autoit3 utility from a suspicious parent process and location. AutoIt3.exe is used within the DarkGate infection chain to execute shellcode that performs process injection and connects to the DarkGate command-and-control server.
references: https://github.com/SigmaHQ/sigma/blob/master/rules-emerging-threats/2023/Malware/DarkGate/proc_creation_win_malware_darkgate_autoit3_from_susp_parent_and_location.yml
tags: darkgate, execution, t1059
search_query: os_type:windows AND (((process_name:Autoit3.exe OR original_filename:AutoIt3.exe) AND (parent_name:cmd.exe OR parent_name:KeyScramblerLogon.exe OR parent_name:msiexec.exe)) AND -(path:":\Program\ Files\ (x86)\AutoIt3\AutoIt3.exe" OR path:":\Program\ Files\AutoIt3\AutoIt3.exe"))
on_hit: alert, syslog