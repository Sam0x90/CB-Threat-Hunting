name: Yellow Cockatoo - Defense Evasion, T1140 Loading of suspicious .NET methods in powershell
index_type: events
description: Detects the loading of suspicious .NET methods, primarily seen in PowerShell script load content. This behavior is not limited to Yellow Cockatoo and can be applied universally for malicious PowerShell obfuscation attempts.
references: 
    - https://redcanary.com/threat-detection-report/threats/yellow-cockatoo/
    - https://attack.mitre.org/techniques/T1140/
tags: defense_evasion, t1140
search_query: process_name:powershell.exe AND (fileless_scriptload_cmdline:aescryptoserviceprovider OR fileless_scriptload_cmdline:frombase64string OR fileless_scriptload_cmdline:user32.dll)
on_hit: alert, syslog
