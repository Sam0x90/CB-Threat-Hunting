name: Pikabot - Defense Evasion Pikabot fake DLL extension execution via rundll32
index_type: events
description: Detects specific process tree behavior linked to "rundll32" executions, wherein the associated DLL lacks a common ".dll" extension, often signaling potential Pikabot activity.
references: https://github.com/SigmaHQ/sigma/blob/master/rules-emerging-threats/2023/Malware/Pikabot/proc_creation_win_malware_pikabot_rundll32_uncommon_extension.yml
tags: pikabot, defense_evasion
search_query: os_type:windows AND (((parent_name:cmd.exe OR parent_name:cscript.exe OR parent_name:mshta.exe OR parent_name:powershell.exe OR parent_name:pwsh.exe OR parent_name:regsvr32.exe OR parent_name:wscript.exe) AND process_name:rundll32.exe AND (cmdline:"\\ProgramData" OR cmdline:"\\Users\\Public" OR cmdline:"\\Windows\\Installer" OR cmdline:"\\AppData\\Local\\Temp" OR cmdline:"\\AppData\\Roaming")) AND -((cmdline:.cpl OR cmdline:".cpl," OR cmdline:.dll OR cmdline:".dll," OR cmdline:.inf OR cmdline:".inf,") OR (cmdline:.cpl OR cmdline:.dll OR cmdline:.inf)))
on_hit: alert, syslog